<!doctype html><html lang=zh-cn>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no">
<meta name=keyword content>
<link rel=icon href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âŒš</text></svg>">
<title>GTX3060æˆåŠŸå®‰è£…tensorflow-gpuè¿‡ç¨‹è®°å½•-ä¸€ä¸ªè€ä¼™è®¡å¿ƒä¸­çš„å°‘å¹´ã€‚PS:è¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰CSSçš„ç«™ç‚¹</title><link rel=stylesheet href=//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.0/build/styles/tomorrow-night-blue.min.css>
<link rel=stylesheet href=/css/alone.css>
<script>var _hmt=_hmt||[];(function(){var e=document.createElement("script"),t;e.src="https://hm.baidu.com/hm.js?d2b64b94332edb95313ab7ff3a2b2f56",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script>
</head><body><header class=homepage-header>
<h1>âŒšï¸è€ç‹</h1><span class=subtitle>ä¸€ä¸ªè€ä¼™è®¡å¿ƒä¸­çš„å°‘å¹´ã€‚PS:è¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰CSSçš„ç«™ç‚¹</span>
</header><hr>
&nbsp;&nbsp;<a href=/>ğŸ é¦–é¡µ</a>&nbsp;&nbsp;
|&nbsp;&nbsp;<a class=navbar-item href=/categories/%E5%85%B3%E4%BA%8E>ğŸ“å…³äº</a>&nbsp;&nbsp;
|&nbsp;&nbsp;<a class=navbar-item href=/categories/%E5%A4%A9%E6%96%87>ğŸ“å¤©æ–‡</a>&nbsp;&nbsp;
|&nbsp;&nbsp;<a class=navbar-item href=/categories/%E7%A8%8B%E5%BA%8F%E5%91%98%E6%9D%82%E5%BF%97>ğŸ“ç¨‹åºå‘˜æ‚å¿—</a>&nbsp;&nbsp;
|&nbsp;&nbsp;<a class=navbar-item href=/categories/%E8%B5%84%E6%BA%90%E4%B8%8B%E8%BD%BD>ğŸ“èµ„æºä¸‹è½½</a>&nbsp;&nbsp;
|&nbsp;&nbsp;<a href=https://github.com/OlddogClock/oldman.wang/issues title=âœï¸ç»™æˆ‘ç•™è¨€ target=_blank>âœï¸ç»™æˆ‘ç•™è¨€</a>
<hr>
<article>
<div class=container>
<h2>ğŸ“–GTX3060æˆåŠŸå®‰è£…tensorflow-gpuè¿‡ç¨‹è®°å½•</h2><hr>
<h5>æ–‡ç« ç›®å½•</h5><ul class=nav>
<ul class=nav>
<li><a href=#%e6%98%be%e5%8d%a1%e5%92%8c%e7%b3%bb%e7%bb%9f%e5%9f%ba%e6%9c%ac%e6%83%85%e5%86%b5>
æ˜¾å¡å’Œç³»ç»ŸåŸºæœ¬æƒ…å†µ
</a></li></ul></ul><ul class=nav>
<ul class=nav>
<li><a href=#%e5%ae%89%e8%a3%85%e6%ad%a5%e9%aa%a4>
å®‰è£…æ­¥éª¤
</a></li></ul></ul><ul class=nav>
<ul class=nav>
<ul class=nav>
<li><a href=#%e7%a1%ae%e5%ae%9a%e7%89%88%e6%9c%ac%e4%bf%a1%e6%81%af>
ç¡®å®šç‰ˆæœ¬ä¿¡æ¯
</a></li></ul></ul></ul><ul class=nav>
<ul class=nav>
<ul class=nav>
<li><a href=#%e4%b8%8b%e8%bd%bd%e5%ae%89%e8%a3%85>
ä¸‹è½½å®‰è£…
</a></li></ul></ul></ul><ul class=nav>
<ul class=nav>
<ul class=nav>
<li><a href=#%e8%ae%be%e7%bd%ae%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f>
è®¾ç½®ç¯å¢ƒå˜é‡
</a></li></ul></ul></ul><ul class=nav>
<ul class=nav>
<ul class=nav>
<li><a href=#%e5%ae%89%e8%a3%85tensorflow_gpu>
å®‰è£…tensorflow_gpu
</a></li></ul></ul></ul><ul class=nav>
<ul class=nav>
<li><a href=#%e5%a4%b1%e8%b4%a5%e7%9a%84%e6%83%85%e5%86%b5>
å¤±è´¥çš„æƒ…å†µ
</a></li></ul></ul><ul class=nav>
<ul class=nav>
<li><a href=#%e4%b8%bawindows-terminal%e5%a2%9e%e5%8a%a0anaconda-prompt>
ä¸ºWindows Terminalå¢åŠ Anaconda prompt
</a></li></ul></ul><ul class=nav>
<ul class=nav>
<li><a href=#%e4%b8%ba%e4%bb%80%e4%b9%88%e4%bb%bb%e5%8a%a1%e7%ae%a1%e7%90%86%e5%99%a8%e4%b8%ad%e6%b2%a1%e6%9c%89cuda%e5%9b%be%e8%a1%a8>
ä¸ºä»€ä¹ˆä»»åŠ¡ç®¡ç†å™¨ä¸­æ²¡æœ‰CUDAå›¾è¡¨
</a></li></ul></ul><hr>
<p>Windows10ä¸‹æˆåŠŸå®‰è£…Tensorflow-GPUè¿‡ç¨‹ï¼ˆGTX 3060ï¼‰</p><p>æœ¬æ–‡æ‰€è¿°äº‹æƒ…å‘ç”Ÿåœ¨2021å¹´11æœˆ6æ—¥ï¼Œç‰¹æ„å¼ºè°ƒæ—¶é—´æ˜¯å› ä¸ºçœ‹è¿‡ä¸€äº›æ—§çš„æ•™ç¨‹ï¼Œè¸©è¿‡å‘ã€‚</p><p>é‡ç‚¹æ˜¯æ˜¾å¡é©±åŠ¨ã€CUDAã€cudnnã€tensorflow-gpuçš„ç‰ˆæœ¬åº”å¯¹ã€‚tensorflowçš„å®‰è£…æ–‡æ¡£åŸºæœ¬ä¸ç”¨çœ‹</p><h2 id=æ˜¾å¡å’Œç³»ç»ŸåŸºæœ¬æƒ…å†µ>æ˜¾å¡å’Œç³»ç»ŸåŸºæœ¬æƒ…å†µ</h2><ul>
<li>GIGABYTE RTX 3060 GAMING OC Rev. 2.0ï¼ˆGV-N3060GAMING OC-12GDï¼‰æŠ€å˜‰é­”é¹°2.0æ˜¾å¡ï¼Œè¿™æ˜¯å—é”ç®—åŠ›çš„å¡ï¼›</li><li>Windows 10 ä¼ä¸šç‰ˆ64bit 21H1ï¼Œ19043.1320</li><li>Anaconda3ï¼Œpython3.7ï¼Œtensorflow-gpu-2.7.0</li><li>æ˜¾å¡é©±åŠ¨GameReady 471.41ï¼ŒCUDA v11.2.2ï¼Œcudnn v8.1.1</li><li>å…¶ä»–é…ç½®ï¼š
<ul>
<li>CPUï¼šAMD Ryzen 7 3700X</li><li>ä¸»æ¿ï¼šGigabyte B550I Aorus Pro AX</li><li>å†…å­˜ï¼šé‡‘å£«é¡¿ DDR4 3200MHz 16G</li></ul></li></ul><p><img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/gpu2.gif alt></p><h2 id=å®‰è£…æ­¥éª¤>å®‰è£…æ­¥éª¤</h2><ol start=0>
<li>åˆ†ä¸º"ç¡®å®šç‰ˆæœ¬ä¿¡æ¯ã€ä¸‹è½½å®‰è£…cudaã€è®¾ç½®ç¯å¢ƒå˜é‡ã€å®‰è£…tf"ï¼Œå››ä¸ªå¤§æ­¥éª¤</li></ol><h3 id=ç¡®å®šç‰ˆæœ¬ä¿¡æ¯>ç¡®å®šç‰ˆæœ¬ä¿¡æ¯</h3><ol>
<li>
<p>å®‰è£…æ˜¾å¡é©±åŠ¨ï¼Œæˆ‘ç”¨çš„GameReadyç‰ˆï¼Œæœ€é«˜ç‰ˆæœ¬æ˜¯496.xxï¼Œæ²¡è¿½æ–°ï¼Œç”¨çš„æ˜¯471.41ï¼›</p></li><li>
<p>ç¡®è®¤è‡ªå·±èƒ½å®‰è£…ä»€ä¹ˆç‰ˆæœ¬çš„CUDAã€‚æ‰“å¼€"NVIDAæ§åˆ¶é¢æ¿"&ndash;>å¸®åŠ©&ndash;>ç³»ç»Ÿä¿¡æ¯&ndash;>æŸ¥çœ‹NVCUDA64.DLLåé¢å¯¹åº”çš„NVIDIA CUDAç‰ˆæœ¬ï¼›
<img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/%E6%98%BE%E5%8D%A1%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF.PNG alt>
<img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/%E9%A9%B1%E5%8A%A8%E5%AF%B9%E5%BA%94.PNG alt></p></li><li>
<p>Nvidia GeForce GameReady 471.41é©±åŠ¨æœ€é«˜æ”¯æŒåˆ°CUDA v11.4ï¼Œä½†æ˜¯Tensorflowç›®å‰ä¸æ”¯æŒè¿™ä¹ˆé«˜çš„CUDAç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘æ ¹æ®tfæ–‡æ¡£ä¸­çš„æç¤ºï¼Œå®‰è£…tensorflow_gpu-2.6.0 å¯¹åº”çš„CUDA 11.2
<img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/tf-cuda%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94.PNG alt></p></li></ol><h3 id=ä¸‹è½½å®‰è£…>ä¸‹è½½å®‰è£…</h3><ol start=4>
<li>åœ¨<code>https://developer.nvidia.com/cuda-toolkit-archive</code>ä¸‹è½½CUDA Toolkit 11.2 Update 2ï¼Œç¨åå®‰è£…</li><li>åœ¨<code>https://developer.nvidia.com/rdp/cudnn-archive</code>ä¸‹è½½cuDNN v8.1.1 (Feburary 26th, 2021), for CUDA 11.0,11.1 and 11.2ï¼Œç¨åå®‰è£…</li><li>åœ¨<code>https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/</code>ä¸‹è½½Anaconda3-2021.05-Windows-x86_64.exeï¼Œç›´æ¥å®‰è£…</li><li>å®‰è£…CUDAï¼Œé€‰æ‹©è‡ªå®šä¹‰å®‰è£…ï¼Œæˆ‘åªå‹¾é€‰äº†CUDA->Runtime-Librariesï¼Œå…¶å®ƒéƒ½ä¸å®‰è£…ï¼Œå› ä¸ºç¬¬1æ­¥å®‰è£…é©±åŠ¨æ—¶åŒ…å«äº†ä¸€éƒ¨åˆ†ï¼ŒVisualStudioé›†æˆç­‰åŠŸèƒ½tfä¹Ÿç”¨ä¸åˆ°ï¼›ä½¿ç”¨é»˜è®¤å®‰è£…è·¯å¾„ï¼Œæˆ‘çš„åœ¨C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.2
<img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/cudasetup.PNG alt></li><li>å°†ç¬¬5æ­¥ä¸‹è½½çš„cudnn-11.2-windows-x64-v8.1.1.33.zip\cuda\bin\ä¸‹æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°CUDAç›®å½•C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.2\bin\</li><li>å†å°†cudnn-11.2-windows-x64-v8.1.1.33.zip\cuda\lib\x64 ä¸‹æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.2\lib\x64\</li></ol><h3 id=è®¾ç½®ç¯å¢ƒå˜é‡>è®¾ç½®ç¯å¢ƒå˜é‡</h3><ol start=10>
<li>
<p>åœ¨ç³»ç»Ÿå˜é‡ä¸­ï¼ŒCUDAå®‰è£…ç¨‹åºä¼šè‡ªåŠ¨å¢åŠ <code>CUDA_PATH</code>å’Œ<code>CUDA_PATH_V11_2</code>å˜é‡å–å€¼ä¸ºå®‰è£…ç›®å½•ï¼Œæ— éœ€äººä¸ºå¹²é¢„
<img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F1.PNG alt></p></li><li>
<p>ä¿®æ”¹ç³»ç»Ÿå˜é‡çš„Pathå˜é‡ï¼Œåœ¨æœ€å‰é¢å¢åŠ <code>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.2\bin;C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.2\lib\x64;</code>ä¸¤ä¸ªç›®å½•
<img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F2.PNG alt></p></li><li>
<p>åœ¨ç³»ç»Ÿå˜é‡ä¸­ï¼Œå¢åŠ å˜é‡å<code>TF_GEFORCE_GPU_ALLOW_GROWTH</code>ï¼Œå–å€¼ä¸ºtrueã€‚ä¸çŸ¥å¹²å˜›çš„ï¼Œä»åˆ«äººæ•™ç¨‹é‡Œæ¬è¿‡æ¥çš„</p></li><li>
<p>é‡å¯</p></li></ol><h3 id=å®‰è£…tensorflow_gpu>å®‰è£…tensorflow_gpu</h3><ol start=14>
<li>åˆ›å»ºä¸€ä¸ªtfç¯å¢ƒ<code>conda create -n mytf python=3.7</code>ã€‚æˆ‘ä¹‹å‰å¤±è´¥çš„å°è¯•éƒ½æ˜¯py3.8ï¼Œè¿™æ¬¡å°è¯•ä½¿ç”¨py3.7æˆåŠŸäº†ï¼Œä¸çŸ¥é“pyç‰ˆæœ¬æ˜¯å¦æœ‰å…³ç³»ï¼ŒæŒ‰ç…§tfå®˜æ–¹æ–‡æ¡£ï¼Œ3.8æ˜¯å¯ä»¥çš„</li><li>è¿›å…¥tfç¯å¢ƒ<code>conda activate mytf</code>ï¼›æˆ‘ä»¥ä¸ºç°åœ¨tfçš„æœ€é«˜ç‰ˆæœ¬æ˜¯2.6.0ï¼Œä¸Šé¢çš„å®‰è£…ä¹Ÿéƒ½æ˜¯ç…§ç€tf2.6.0æ¥çš„ï¼Œæ‰€ä»¥å®‰è£…tfæ—¶æ²¡æœ‰å¸¦ç‰ˆæœ¬å·ï¼Œç›´æ¥<code>pip install tensorflow-gpu -i https://pypi.doubanio.com/simple/</code>ï¼Œç»“æœå‘ç°å®‰è£…çš„æ˜¯2.7.0</li><li>æµ‹è¯•ä»£ç å¦‚ä¸‹</li></ol><pre tabindex=0><code>import tensorflow as tf
print(&#39;GPU&#39;,tf.config.list_physical_devices(&#39;GPU&#39;))
print(&#34;Num GPUs Available: &#34;, len(tf.config.experimental.list_physical_devices(&#39;GPU&#39;)))
</code></pre><p>æˆ‘åªæœ‰ä¸€å—GTX3060æ˜¾å¡ï¼Œæ‰§è¡Œåè¿”å›:</p><pre tabindex=0><code>GPU [PhysicalDevice(name=&#39;/physical_device:GPU:0&#39;, device_type=&#39;GPU&#39;)]
Num GPUs Available:  1
</code></pre><p>åˆ°æ­¤ä¸ºå®‰è£…æˆåŠŸã€‚</p><h2 id=å¤±è´¥çš„æƒ…å†µ>å¤±è´¥çš„æƒ…å†µ</h2><p>CUDA11.1ï¼‹cuDNN8.0.5ï¼‹tensorflow-gpu2.4.1ï¼Œç…§åˆ«äºº3060å®‰è£…æˆåŠŸçš„æ•™ç¨‹æ¬è¿‡æ¥çš„ï¼Œåœ¨æˆ‘è¿™å¤±è´¥ï¼Œæç¤ºcusolver64_10.dllä¸¢å¤±ï¼Œå½“æ—¶ç”¨çš„Python3.8ï¼Œæ˜¾å¡é©±åŠ¨496.xx</p><h2 id=ä¸ºwindows-terminalå¢åŠ anaconda-prompt>ä¸ºWindows Terminalå¢åŠ Anaconda prompt</h2><p>Windows Terminalæ˜¯Win10ä¸‹å¾ˆå¥½ç”¨çš„ä¸€ä¸ªç»ˆç«¯ï¼Œä½†æ˜¯é»˜è®¤æ— æ³•æ˜¾ç¤ºå‡ºcondaçš„ç¯å¢ƒåç§°ï¼Œå¯ä»¥æ‰‹å·¥å¢åŠ ï¼š
æ‰“å¼€Windows Terminalè®¾ç½®ï¼Œå†å·¦ä¸‹è§’çš„"æ‰“å¼€JSONæ–‡ä»¶"</p><p><img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/wt.PNG alt></p><p>profiles.listæ•°ç»„å¢åŠ å¦‚ä¸‹ä»£ç åï¼Œé‡æ–°æ‰“å¼€Windows Terminalå³å¯ï¼š</p><pre tabindex=0><code>{
    &#34;bellStyle&#34;: 
    [
        &#34;window&#34;,
        &#34;taskbar&#34;
    ],

    //å°†Anaconda Powershell Prompt (Anaconda3)å¿«æ·æ–¹å¼å±æ€§ä¸­çš„&#34;ç›®æ ‡&#34;å¤åˆ¶åˆ°commandlineå­—æ®µä¸­ï¼Œ\å’Œ&#34;ç¬¦å·å‰è¦åŠ \é¿å…è¢«è½¬ä¹‰
    &#34;commandline&#34;: &#34;%windir%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ExecutionPolicy ByPass -NoExit -Command \&#34;&amp; &#39;C:\\ProgramData\\Anaconda3\\shell\\condabin\\conda-hook.ps1&#39; ; conda activate &#39;C:\\ProgramData\\Anaconda3&#39; \&#34;&#34;,  

    //è‡ªå·±ç”Ÿæˆä¸€ä¸ªguidï¼Œç”¨ä¸‹é¢çš„ä¹Ÿè¡Œï¼Œåªè¦å’Œä¸Šé¢ä¸é‡å¤å³å¯
    &#34;guid&#34;: &#34;{45b48db0-01a4-4d92-937b-60f9928e8c5c}&#34;,
    &#34;hidden&#34;: false,

    //æ‰¾ä¸ªå¥½çœ‹çš„icon
    &#34;icon&#34;: &#34;C:\\ProgramData\\Anaconda3\\Menu\\anaconda-navigator.ico&#34;,

    //Windows Terminalèœå•ä¸­æ˜¾ç¤ºçš„åç§°
    &#34;name&#34;: &#34;Anaconda Prompt&#34;
}
</code></pre><p><img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/wt2.PNG alt></p><h2 id=ä¸ºä»€ä¹ˆä»»åŠ¡ç®¡ç†å™¨ä¸­æ²¡æœ‰cudaå›¾è¡¨>ä¸ºä»€ä¹ˆä»»åŠ¡ç®¡ç†å™¨ä¸­æ²¡æœ‰CUDAå›¾è¡¨</h2><p>å®‰è£…å®ŒCUDAåï¼ŒWindowsä»»åŠ¡ç®¡ç†å™¨&ndash;>æ€§èƒ½&ndash;>GPUå›¾è¡¨é‡Œä¼šæœ‰CUDAè¿™ä¸€é€‰é¡¹ï¼Œ
<img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/640.png alt></p><p>è¿™ä¸ªé€‰é¡¹å¹¶ä¸èƒ½åˆ¤æ–­CUDAæ˜¯å¦å®‰è£…æˆåŠŸï¼Œå¦‚æœå¼€å¯äº†Windowsè®¾ç½®&ndash;æ˜¾ç¤º-å›¾å½¢è®¾ç½®&ndash;ç¡¬ä»¶åŠ é€Ÿï¼Œåˆ™ä»»åŠ¡ç®¡ç†å™¨ä¸­çš„CUDAé€‰é¡¹ä¼šæ¶ˆå¤±
<img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/task2.PNG alt>
<img src=https://oldmanblog.oss-cn-guangzhou.aliyuncs.com/task1.PNG alt></p><hr>
<p>
<a href=/p/2021%E5%B9%B4%E5%95%86%E4%B8%9A%E5%8D%8A%E5%95%86%E4%B8%9A%E8%BF%90%E4%BD%9C%E8%BF%9C%E7%A8%8B%E5%A4%A9%E6%96%87%E5%8F%B0%E4%B8%8D%E5%AE%8C%E5%85%A8%E6%B1%87%E6%80%BB/ title=2021å¹´å•†ä¸šã€åŠå•†ä¸šè¿ä½œè¿œç¨‹å¤©æ–‡å°ä¸å®Œå…¨æ±‡æ€»>
ã€Š2021å¹´å•†ä¸šã€åŠå•†ä¸šè¿ä½œè¿œç¨‹å¤©æ–‡å°ä¸å®Œå…¨æ±‡æ€»ã€‹</a>â¬…
ğŸ§°
â¡<a href=/p/%E4%B8%BAwindows%E6%89%93%E9%80%A0%E5%AE%8C%E7%BE%8E%E7%BB%88%E7%AB%AF%E9%9D%9Ewsl/ title=ä¸ºWindowsæ‰“é€ å®Œç¾ç»ˆç«¯ï¼ˆéWSLï¼‰>ã€Šä¸ºWindowsæ‰“é€ å®Œç¾ç»ˆç«¯ï¼ˆéWSLï¼‰ã€‹</a>
</p></div></div></article><hr>
&copy; 2022 Powered by <a href=https://gohugo.io target=_blank>Hugo</a>, Themes <a href=https://github.com/OlddogClock/nocss-hugo target=_blank>nocss-hugo</a>
<script src=//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.0/build/highlight.min.js></script>
<script>hljs.highlightAll()</script>
</body></html>